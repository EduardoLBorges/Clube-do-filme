<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8">
  <title>Clube do Filme</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
  <h1>ğŸ¬ Filme da Semana: 2001: Uma Odisseia no EspaÃ§o</h1>

<form method="post">
  <label>Seu nome:</label>
  <input name="nome" placeholder="Digite seu nome" required>

  {% for campo in ['roteiro', 'atuacao', 'direcao', 'fotografia', 'trilha', 'montagem', 'impacto'] %}
    <div class="estrelas-box">
      <label>{{ campo.capitalize() }}:</label>
      <div class="estrelas" data-name="{{ campo }}">
        {% for i in range(1, 6) %}
          <span class="estrela" data-value="{{ i }}">&#9733;</span>
        {% endfor %}
      </div>
      <input type="hidden" name="{{ campo }}" required>
    </div>
  {% endfor %}

  <label>CrÃ­tica:</label>
  <textarea name="critica" placeholder="Escreva sua opiniÃ£o..." required></textarea>

  <button type="submit">Enviar AvaliaÃ§Ã£o</button>
</form>

  <h2>AvaliaÃ§Ãµes Recentes</h2>
  {% for a in avaliacoes %}
    <div class="avaliacao">
      <strong>{{ a[1] }}</strong> em {{ a[-1].strftime('%d/%m/%Y %H:%M') }}:
      <ul>
        <li>ğŸï¸ Roteiro: {{ a[2] }} | ğŸ­ AtuaÃ§Ã£o: {{ a[3] }} | ğŸ¬ DireÃ§Ã£o: {{ a[4] }}</li>
        <li>ğŸ“· Fotografia: {{ a[5] }} | ğŸ¶ Trilha: {{ a[6] }} | âœ‚ï¸ Montagem: {{ a[7] }} | ğŸ’¥ Impacto: {{ a[8] }}</li>
      </ul>
      <p><em>{{ a[9] }}</em></p>
    </div>
  {% endfor %}

</body>
</html>

<script>
  document.querySelectorAll('.estrelas').forEach(estrelasBox => {
    const estrelas = estrelasBox.querySelectorAll('.estrela');
    const hiddenInput = estrelasBox.nextElementSibling;

    estrelas.forEach(estrela => {
      estrela.addEventListener('click', () => {
        const valor = parseInt(estrela.getAttribute('data-value'));
        hiddenInput.value = valor;

        estrelas.forEach(e => {
          e.classList.toggle('ativa', parseInt(e.getAttribute('data-value')) <= valor);
        });
      });
    });
  });
</script>
